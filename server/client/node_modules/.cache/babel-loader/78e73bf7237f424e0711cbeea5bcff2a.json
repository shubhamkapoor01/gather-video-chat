{"ast":null,"code":"/**\r\n    * @license\r\n    * Copyright 2021 Google LLC. All Rights Reserved.\r\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    * you may not use this file except in compliance with the License.\r\n    * You may obtain a copy of the License at\r\n    *\r\n    * http://www.apache.org/licenses/LICENSE-2.0\r\n    *\r\n    * Unless required by applicable law or agreed to in writing, software\r\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    * See the License for the specific language governing permissions and\r\n    * limitations under the License.\r\n    * =============================================================================\r\n    */\nimport { slice, add, div, sub, mul, concat2d, Tensor, tidy, concat, tensor1d, squeeze, tensor2d, image, sigmoid, reshape, browser, expandDims, cast } from \"@tensorflow/tfjs-core\";\nimport { loadGraphModel } from \"@tensorflow/tfjs-converter\";\n\nfunction __awaiter(e, t, n, r) {\n  return new (n || (n = Promise))(function (o, i) {\n    function a(e) {\n      try {\n        c(r.next(e));\n      } catch (e) {\n        i(e);\n      }\n    }\n\n    function s(e) {\n      try {\n        c(r.throw(e));\n      } catch (e) {\n        i(e);\n      }\n    }\n\n    function c(e) {\n      var t;\n      e.done ? o(e.value) : (t = e.value, t instanceof n ? t : new n(function (e) {\n        e(t);\n      })).then(a, s);\n    }\n\n    c((r = r.apply(e, t || [])).next());\n  });\n}\n\nfunction __generator(e, t) {\n  var n,\n      r,\n      o,\n      i,\n      a = {\n    label: 0,\n    sent: function () {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: s(0),\n    throw: s(1),\n    return: s(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function s(i) {\n    return function (s) {\n      return function (i) {\n        if (n) throw new TypeError(\"Generator is already executing.\");\n\n        for (; a;) try {\n          if (n = 1, r && (o = 2 & i[0] ? r.return : i[0] ? r.throw || ((o = r.return) && o.call(r), 0) : r.next) && !(o = o.call(r, i[1])).done) return o;\n\n          switch (r = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n            case 0:\n            case 1:\n              o = i;\n              break;\n\n            case 4:\n              return a.label++, {\n                value: i[1],\n                done: !1\n              };\n\n            case 5:\n              a.label++, r = i[1], i = [0];\n              continue;\n\n            case 7:\n              i = a.ops.pop(), a.trys.pop();\n              continue;\n\n            default:\n              if (!(o = (o = a.trys).length > 0 && o[o.length - 1]) && (6 === i[0] || 2 === i[0])) {\n                a = 0;\n                continue;\n              }\n\n              if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                a.label = i[1];\n                break;\n              }\n\n              if (6 === i[0] && a.label < o[1]) {\n                a.label = o[1], o = i;\n                break;\n              }\n\n              if (o && a.label < o[2]) {\n                a.label = o[2], a.ops.push(i);\n                break;\n              }\n\n              o[2] && a.ops.pop(), a.trys.pop();\n              continue;\n          }\n\n          i = t.call(e, a);\n        } catch (e) {\n          i = [6, e], r = 0;\n        } finally {\n          n = o = 0;\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, s]);\n    };\n  }\n}\n\nvar disposeBox = function (e) {\n  e.startEndTensor.dispose(), e.startPoint.dispose(), e.endPoint.dispose();\n},\n    createBox = function (e) {\n  return {\n    startEndTensor: e,\n    startPoint: slice(e, [0, 0], [-1, 2]),\n    endPoint: slice(e, [0, 2], [-1, 2])\n  };\n},\n    scaleBox = function (e, t) {\n  var n = mul(e.startPoint, t),\n      r = mul(e.endPoint, t),\n      o = concat2d([n, r], 1);\n  return createBox(o);\n},\n    ANCHORS_CONFIG = {\n  strides: [8, 16],\n  anchors: [2, 6]\n},\n    NUM_LANDMARKS = 6;\n\nfunction generateAnchors(e, t, n) {\n  for (var r = [], o = 0; o < n.strides.length; o++) for (var i = n.strides[o], a = Math.floor((t + i - 1) / i), s = Math.floor((e + i - 1) / i), c = n.anchors[o], l = 0; l < a; l++) for (var u = i * (l + .5), d = 0; d < s; d++) for (var h = i * (d + .5), f = 0; f < c; f++) r.push([h, u]);\n\n  return r;\n}\n\nfunction decodeBounds(e, t, n) {\n  var r = slice(e, [0, 1], [-1, 2]),\n      o = add(r, t),\n      i = slice(e, [0, 3], [-1, 2]),\n      a = div(i, n),\n      s = div(o, n),\n      c = div(a, 2),\n      l = sub(s, c),\n      u = add(s, c),\n      d = mul(l, n),\n      h = mul(u, n);\n  return concat2d([d, h], 1);\n}\n\nfunction getInputTensorDimensions(e) {\n  return e instanceof Tensor ? [e.shape[0], e.shape[1]] : [e.height, e.width];\n}\n\nfunction flipFaceHorizontal(e, t) {\n  var n, r, o;\n\n  if (e.topLeft instanceof Tensor && e.bottomRight instanceof Tensor) {\n    var i = tidy(function () {\n      return [concat([slice(sub(t - 1, e.topLeft), 0, 1), slice(e.topLeft, 1, 1)]), concat([sub(t - 1, slice(e.bottomRight, 0, 1)), slice(e.bottomRight, 1, 1)])];\n    });\n    n = i[0], r = i[1], null != e.landmarks && (o = tidy(function () {\n      var n = sub(tensor1d([t - 1, 0]), e.landmarks),\n          r = tensor1d([1, -1]);\n      return mul(n, r);\n    }));\n  } else {\n    var a = e.topLeft,\n        s = a[0],\n        c = a[1],\n        l = e.bottomRight,\n        u = l[0],\n        d = l[1];\n    n = [t - 1 - s, c], r = [t - 1 - u, d], null != e.landmarks && (o = e.landmarks.map(function (e) {\n      return [t - 1 - e[0], e[1]];\n    }));\n  }\n\n  var h = {\n    topLeft: n,\n    bottomRight: r\n  };\n  return null != o && (h.landmarks = o), null != e.probability && (h.probability = e.probability instanceof Tensor ? e.probability.clone() : e.probability), h;\n}\n\nfunction scaleBoxFromPrediction(e, t) {\n  return tidy(function () {\n    var n;\n    return n = e.hasOwnProperty(\"box\") ? e.box : e, squeeze(scaleBox(n, t).startEndTensor);\n  });\n}\n\nvar BlazeFaceModel = function () {\n  function e(e, t, n, r, o, i) {\n    this.blazeFaceModel = e, this.width = t, this.height = n, this.maxFaces = r, this.anchorsData = generateAnchors(t, n, ANCHORS_CONFIG), this.anchors = tensor2d(this.anchorsData), this.inputSizeData = [t, n], this.inputSize = tensor1d([t, n]), this.iouThreshold = o, this.scoreThreshold = i;\n  }\n\n  return e.prototype.getBoundingBoxes = function (e, t, n) {\n    return void 0 === n && (n = !0), __awaiter(this, void 0, void 0, function () {\n      var r,\n          o,\n          i,\n          a,\n          s,\n          c,\n          l,\n          u,\n          d,\n          h,\n          f,\n          p,\n          b,\n          m,\n          v = this;\n      return __generator(this, function (y) {\n        switch (y.label) {\n          case 0:\n            return r = tidy(function () {\n              var t = image.resizeBilinear(e, [v.width, v.height]),\n                  n = mul(sub(div(t, 255), .5), 2),\n                  r = v.blazeFaceModel.predict(n),\n                  o = squeeze(r),\n                  i = decodeBounds(o, v.anchors, v.inputSize),\n                  a = slice(o, [0, 0], [-1, 1]);\n              return [o, i, squeeze(sigmoid(a))];\n            }), o = r[0], i = r[1], a = r[2], s = console.warn, console.warn = function () {}, c = image.nonMaxSuppression(i, a, this.maxFaces, this.iouThreshold, this.scoreThreshold), console.warn = s, [4, c.array()];\n\n          case 1:\n            return l = y.sent(), c.dispose(), u = l.map(function (e) {\n              return slice(i, [e, 0], [1, -1]);\n            }), t ? [3, 3] : [4, Promise.all(u.map(function (e) {\n              return __awaiter(v, void 0, void 0, function () {\n                var t;\n                return __generator(this, function (n) {\n                  switch (n.label) {\n                    case 0:\n                      return [4, e.array()];\n\n                    case 1:\n                      return t = n.sent(), e.dispose(), [2, t];\n                  }\n                });\n              });\n            }))];\n\n          case 2:\n            u = y.sent(), y.label = 3;\n\n          case 3:\n            for (d = e.shape[1], h = e.shape[2], f = t ? div([h, d], this.inputSize) : [h / this.inputSizeData[0], d / this.inputSizeData[1]], p = [], b = function (e) {\n              var r = u[e],\n                  i = tidy(function () {\n                var i = createBox(r instanceof Tensor ? r : tensor2d(r));\n                if (!n) return i;\n                var s,\n                    c = l[e];\n                return s = t ? slice(v.anchors, [c, 0], [1, 2]) : v.anchorsData[c], {\n                  box: i,\n                  landmarks: reshape(squeeze(slice(o, [c, NUM_LANDMARKS - 1], [1, -1])), [NUM_LANDMARKS, -1]),\n                  probability: slice(a, [c], [1]),\n                  anchor: s\n                };\n              });\n              p.push(i);\n            }, m = 0; m < u.length; m++) b(m);\n\n            return i.dispose(), a.dispose(), o.dispose(), [2, {\n              boxes: p,\n              scaleFactor: f\n            }];\n        }\n      });\n    });\n  }, e.prototype.estimateFaces = function (e, t, n, r) {\n    return void 0 === t && (t = !1), void 0 === n && (n = !1), void 0 === r && (r = !0), __awaiter(this, void 0, void 0, function () {\n      var o,\n          i,\n          a,\n          s,\n          c,\n          l,\n          u = this;\n      return __generator(this, function (d) {\n        switch (d.label) {\n          case 0:\n            return o = getInputTensorDimensions(e), i = o[1], a = tidy(function () {\n              return e instanceof Tensor || (e = browser.fromPixels(e)), expandDims(cast(e, \"float32\"), 0);\n            }), [4, this.getBoundingBoxes(a, t, r)];\n\n          case 1:\n            return s = d.sent(), c = s.boxes, l = s.scaleFactor, a.dispose(), t ? [2, c.map(function (e) {\n              var t = scaleBoxFromPrediction(e, l),\n                  o = {\n                topLeft: slice(t, [0], [2]),\n                bottomRight: slice(t, [2], [2])\n              };\n\n              if (r) {\n                var a = e,\n                    s = a.landmarks,\n                    c = a.probability,\n                    u = a.anchor,\n                    d = mul(add(s, u), l);\n                o.landmarks = d, o.probability = c;\n              }\n\n              return n && (o = flipFaceHorizontal(o, i)), o;\n            })] : [2, Promise.all(c.map(function (e) {\n              return __awaiter(u, void 0, void 0, function () {\n                var t,\n                    o,\n                    a,\n                    s,\n                    c,\n                    u,\n                    d,\n                    h,\n                    f,\n                    p,\n                    b,\n                    m = this;\n                return __generator(this, function (v) {\n                  switch (v.label) {\n                    case 0:\n                      return t = scaleBoxFromPrediction(e, l), r ? [3, 2] : [4, t.array()];\n\n                    case 1:\n                      return c = v.sent(), o = {\n                        topLeft: c.slice(0, 2),\n                        bottomRight: c.slice(2)\n                      }, [3, 4];\n\n                    case 2:\n                      return [4, Promise.all([e.landmarks, t, e.probability].map(function (e) {\n                        return __awaiter(m, void 0, void 0, function () {\n                          return __generator(this, function (t) {\n                            return [2, e.array()];\n                          });\n                        });\n                      }))];\n\n                    case 3:\n                      a = v.sent(), s = a[0], c = a[1], u = a[2], d = e.anchor, f = (h = l)[0], p = h[1], b = s.map(function (e) {\n                        return [(e[0] + d[0]) * f, (e[1] + d[1]) * p];\n                      }), o = {\n                        topLeft: c.slice(0, 2),\n                        bottomRight: c.slice(2),\n                        landmarks: b,\n                        probability: u\n                      }, disposeBox(e.box), e.landmarks.dispose(), e.probability.dispose(), v.label = 4;\n\n                    case 4:\n                      return t.dispose(), n && (o = flipFaceHorizontal(o, i)), [2, o];\n                  }\n                });\n              });\n            }))];\n        }\n      });\n    });\n  }, e;\n}(),\n    BLAZEFACE_MODEL_URL = \"https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1\";\n\nfunction load(e) {\n  var t = void 0 === e ? {} : e,\n      n = t.maxFaces,\n      r = void 0 === n ? 10 : n,\n      o = t.inputWidth,\n      i = void 0 === o ? 128 : o,\n      a = t.inputHeight,\n      s = void 0 === a ? 128 : a,\n      c = t.iouThreshold,\n      l = void 0 === c ? .3 : c,\n      u = t.scoreThreshold,\n      d = void 0 === u ? .75 : u,\n      h = t.modelUrl;\n  return __awaiter(this, void 0, void 0, function () {\n    var e;\n    return __generator(this, function (t) {\n      switch (t.label) {\n        case 0:\n          return null == h ? [3, 2] : [4, loadGraphModel(h)];\n\n        case 1:\n          return e = t.sent(), [3, 4];\n\n        case 2:\n          return [4, loadGraphModel(BLAZEFACE_MODEL_URL, {\n            fromTFHub: !0\n          })];\n\n        case 3:\n          e = t.sent(), t.label = 4;\n\n        case 4:\n          return [2, new BlazeFaceModel(e, i, s, r, l, d)];\n      }\n    });\n  });\n}\n\nexport { load, BlazeFaceModel };","map":{"version":3,"sources":["C:/Users/mozah/Desktop/Hanzla College files/Gather/ver exp/gather-video-chat/server/client/node_modules/@tensorflow-models/blazeface/dist/blazeface.esm.js"],"names":["slice","add","div","sub","mul","concat2d","Tensor","tidy","concat","tensor1d","squeeze","tensor2d","image","sigmoid","reshape","browser","expandDims","cast","loadGraphModel","__awaiter","e","t","n","r","Promise","o","i","a","c","next","s","throw","done","value","then","apply","__generator","label","sent","trys","ops","return","Symbol","iterator","TypeError","call","pop","length","push","disposeBox","startEndTensor","dispose","startPoint","endPoint","createBox","scaleBox","ANCHORS_CONFIG","strides","anchors","NUM_LANDMARKS","generateAnchors","Math","floor","l","u","d","h","f","decodeBounds","getInputTensorDimensions","shape","height","width","flipFaceHorizontal","topLeft","bottomRight","landmarks","map","probability","clone","scaleBoxFromPrediction","hasOwnProperty","box","BlazeFaceModel","blazeFaceModel","maxFaces","anchorsData","inputSizeData","inputSize","iouThreshold","scoreThreshold","prototype","getBoundingBoxes","p","b","m","v","y","resizeBilinear","predict","console","warn","nonMaxSuppression","array","all","anchor","boxes","scaleFactor","estimateFaces","fromPixels","BLAZEFACE_MODEL_URL","load","inputWidth","inputHeight","modelUrl","fromTFHub"],"mappings":"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","sourcesContent":["/**\r\n    * @license\r\n    * Copyright 2021 Google LLC. All Rights Reserved.\r\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    * you may not use this file except in compliance with the License.\r\n    * You may obtain a copy of the License at\r\n    *\r\n    * http://www.apache.org/licenses/LICENSE-2.0\r\n    *\r\n    * Unless required by applicable law or agreed to in writing, software\r\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    * See the License for the specific language governing permissions and\r\n    * limitations under the License.\r\n    * =============================================================================\r\n    */\r\nimport{slice,add,div,sub,mul,concat2d,Tensor,tidy,concat,tensor1d,squeeze,tensor2d,image,sigmoid,reshape,browser,expandDims,cast}from\"@tensorflow/tfjs-core\";import{loadGraphModel}from\"@tensorflow/tfjs-converter\";function __awaiter(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((r=r.apply(e,t||[])).next())})}function __generator(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError(\"Generator is already executing.\");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var disposeBox=function(e){e.startEndTensor.dispose(),e.startPoint.dispose(),e.endPoint.dispose()},createBox=function(e){return{startEndTensor:e,startPoint:slice(e,[0,0],[-1,2]),endPoint:slice(e,[0,2],[-1,2])}},scaleBox=function(e,t){var n=mul(e.startPoint,t),r=mul(e.endPoint,t),o=concat2d([n,r],1);return createBox(o)},ANCHORS_CONFIG={strides:[8,16],anchors:[2,6]},NUM_LANDMARKS=6;function generateAnchors(e,t,n){for(var r=[],o=0;o<n.strides.length;o++)for(var i=n.strides[o],a=Math.floor((t+i-1)/i),s=Math.floor((e+i-1)/i),c=n.anchors[o],l=0;l<a;l++)for(var u=i*(l+.5),d=0;d<s;d++)for(var h=i*(d+.5),f=0;f<c;f++)r.push([h,u]);return r}function decodeBounds(e,t,n){var r=slice(e,[0,1],[-1,2]),o=add(r,t),i=slice(e,[0,3],[-1,2]),a=div(i,n),s=div(o,n),c=div(a,2),l=sub(s,c),u=add(s,c),d=mul(l,n),h=mul(u,n);return concat2d([d,h],1)}function getInputTensorDimensions(e){return e instanceof Tensor?[e.shape[0],e.shape[1]]:[e.height,e.width]}function flipFaceHorizontal(e,t){var n,r,o;if(e.topLeft instanceof Tensor&&e.bottomRight instanceof Tensor){var i=tidy(function(){return[concat([slice(sub(t-1,e.topLeft),0,1),slice(e.topLeft,1,1)]),concat([sub(t-1,slice(e.bottomRight,0,1)),slice(e.bottomRight,1,1)])]});n=i[0],r=i[1],null!=e.landmarks&&(o=tidy(function(){var n=sub(tensor1d([t-1,0]),e.landmarks),r=tensor1d([1,-1]);return mul(n,r)}))}else{var a=e.topLeft,s=a[0],c=a[1],l=e.bottomRight,u=l[0],d=l[1];n=[t-1-s,c],r=[t-1-u,d],null!=e.landmarks&&(o=e.landmarks.map(function(e){return[t-1-e[0],e[1]]}))}var h={topLeft:n,bottomRight:r};return null!=o&&(h.landmarks=o),null!=e.probability&&(h.probability=e.probability instanceof Tensor?e.probability.clone():e.probability),h}function scaleBoxFromPrediction(e,t){return tidy(function(){var n;return n=e.hasOwnProperty(\"box\")?e.box:e,squeeze(scaleBox(n,t).startEndTensor)})}var BlazeFaceModel=function(){function e(e,t,n,r,o,i){this.blazeFaceModel=e,this.width=t,this.height=n,this.maxFaces=r,this.anchorsData=generateAnchors(t,n,ANCHORS_CONFIG),this.anchors=tensor2d(this.anchorsData),this.inputSizeData=[t,n],this.inputSize=tensor1d([t,n]),this.iouThreshold=o,this.scoreThreshold=i}return e.prototype.getBoundingBoxes=function(e,t,n){return void 0===n&&(n=!0),__awaiter(this,void 0,void 0,function(){var r,o,i,a,s,c,l,u,d,h,f,p,b,m,v=this;return __generator(this,function(y){switch(y.label){case 0:return r=tidy(function(){var t=image.resizeBilinear(e,[v.width,v.height]),n=mul(sub(div(t,255),.5),2),r=v.blazeFaceModel.predict(n),o=squeeze(r),i=decodeBounds(o,v.anchors,v.inputSize),a=slice(o,[0,0],[-1,1]);return[o,i,squeeze(sigmoid(a))]}),o=r[0],i=r[1],a=r[2],s=console.warn,console.warn=function(){},c=image.nonMaxSuppression(i,a,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=s,[4,c.array()];case 1:return l=y.sent(),c.dispose(),u=l.map(function(e){return slice(i,[e,0],[1,-1])}),t?[3,3]:[4,Promise.all(u.map(function(e){return __awaiter(v,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,e.array()];case 1:return t=n.sent(),e.dispose(),[2,t]}})})}))];case 2:u=y.sent(),y.label=3;case 3:for(d=e.shape[1],h=e.shape[2],f=t?div([h,d],this.inputSize):[h/this.inputSizeData[0],d/this.inputSizeData[1]],p=[],b=function(e){var r=u[e],i=tidy(function(){var i=createBox(r instanceof Tensor?r:tensor2d(r));if(!n)return i;var s,c=l[e];return s=t?slice(v.anchors,[c,0],[1,2]):v.anchorsData[c],{box:i,landmarks:reshape(squeeze(slice(o,[c,NUM_LANDMARKS-1],[1,-1])),[NUM_LANDMARKS,-1]),probability:slice(a,[c],[1]),anchor:s}});p.push(i)},m=0;m<u.length;m++)b(m);return i.dispose(),a.dispose(),o.dispose(),[2,{boxes:p,scaleFactor:f}]}})})},e.prototype.estimateFaces=function(e,t,n,r){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!0),__awaiter(this,void 0,void 0,function(){var o,i,a,s,c,l,u=this;return __generator(this,function(d){switch(d.label){case 0:return o=getInputTensorDimensions(e),i=o[1],a=tidy(function(){return e instanceof Tensor||(e=browser.fromPixels(e)),expandDims(cast(e,\"float32\"),0)}),[4,this.getBoundingBoxes(a,t,r)];case 1:return s=d.sent(),c=s.boxes,l=s.scaleFactor,a.dispose(),t?[2,c.map(function(e){var t=scaleBoxFromPrediction(e,l),o={topLeft:slice(t,[0],[2]),bottomRight:slice(t,[2],[2])};if(r){var a=e,s=a.landmarks,c=a.probability,u=a.anchor,d=mul(add(s,u),l);o.landmarks=d,o.probability=c}return n&&(o=flipFaceHorizontal(o,i)),o})]:[2,Promise.all(c.map(function(e){return __awaiter(u,void 0,void 0,function(){var t,o,a,s,c,u,d,h,f,p,b,m=this;return __generator(this,function(v){switch(v.label){case 0:return t=scaleBoxFromPrediction(e,l),r?[3,2]:[4,t.array()];case 1:return c=v.sent(),o={topLeft:c.slice(0,2),bottomRight:c.slice(2)},[3,4];case 2:return[4,Promise.all([e.landmarks,t,e.probability].map(function(e){return __awaiter(m,void 0,void 0,function(){return __generator(this,function(t){return[2,e.array()]})})}))];case 3:a=v.sent(),s=a[0],c=a[1],u=a[2],d=e.anchor,f=(h=l)[0],p=h[1],b=s.map(function(e){return[(e[0]+d[0])*f,(e[1]+d[1])*p]}),o={topLeft:c.slice(0,2),bottomRight:c.slice(2),landmarks:b,probability:u},disposeBox(e.box),e.landmarks.dispose(),e.probability.dispose(),v.label=4;case 4:return t.dispose(),n&&(o=flipFaceHorizontal(o,i)),[2,o]}})})}))]}})})},e}(),BLAZEFACE_MODEL_URL=\"https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1\";function load(e){var t=void 0===e?{}:e,n=t.maxFaces,r=void 0===n?10:n,o=t.inputWidth,i=void 0===o?128:o,a=t.inputHeight,s=void 0===a?128:a,c=t.iouThreshold,l=void 0===c?.3:c,u=t.scoreThreshold,d=void 0===u?.75:u,h=t.modelUrl;return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return null==h?[3,2]:[4,loadGraphModel(h)];case 1:return e=t.sent(),[3,4];case 2:return[4,loadGraphModel(BLAZEFACE_MODEL_URL,{fromTFHub:!0})];case 3:e=t.sent(),t.label=4;case 4:return[2,new BlazeFaceModel(e,i,s,r,l,d)]}})})}export{load,BlazeFaceModel};\r\n"]},"metadata":{},"sourceType":"module"}