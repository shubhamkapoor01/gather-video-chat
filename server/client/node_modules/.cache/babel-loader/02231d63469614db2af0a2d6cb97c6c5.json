{"ast":null,"code":"/**\n    * @license\n    * Copyright 2021 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport { loadGraphModel as t } from \"@tensorflow/tfjs-converter\";\nimport { image as n, tensor2d as e, tensor1d as r, tidy as o, slice as i, add as s, div as a, mul as u, sub as h, concat2d as d, reshape as c, getBackend as f, env as l, squeeze as p, sigmoid as m, util as v, Tensor as P, browser as g, expandDims as b, cast as k } from \"@tensorflow/tfjs-core\";\n\nfunction y(t, n, e, r) {\n  return new (e || (e = Promise))(function (o, i) {\n    function s(t) {\n      try {\n        u(r.next(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function a(t) {\n      try {\n        u(r.throw(t));\n      } catch (t) {\n        i(t);\n      }\n    }\n\n    function u(t) {\n      var n;\n      t.done ? o(t.value) : (n = t.value, n instanceof e ? n : new e(function (t) {\n        t(n);\n      })).then(s, a);\n    }\n\n    u((r = r.apply(t, n || [])).next());\n  });\n}\n\nfunction x(t, n) {\n  var e,\n      r,\n      o,\n      i,\n      s = {\n    label: 0,\n    sent: function () {\n      if (1 & o[0]) throw o[1];\n      return o[1];\n    },\n    trys: [],\n    ops: []\n  };\n  return i = {\n    next: a(0),\n    throw: a(1),\n    return: a(2)\n  }, \"function\" == typeof Symbol && (i[Symbol.iterator] = function () {\n    return this;\n  }), i;\n\n  function a(i) {\n    return function (a) {\n      return function (i) {\n        if (e) throw new TypeError(\"Generator is already executing.\");\n\n        for (; s;) try {\n          if (e = 1, r && (o = 2 & i[0] ? r.return : i[0] ? r.throw || ((o = r.return) && o.call(r), 0) : r.next) && !(o = o.call(r, i[1])).done) return o;\n\n          switch (r = 0, o && (i = [2 & i[0], o.value]), i[0]) {\n            case 0:\n            case 1:\n              o = i;\n              break;\n\n            case 4:\n              return s.label++, {\n                value: i[1],\n                done: !1\n              };\n\n            case 5:\n              s.label++, r = i[1], i = [0];\n              continue;\n\n            case 7:\n              i = s.ops.pop(), s.trys.pop();\n              continue;\n\n            default:\n              if (!(o = s.trys, (o = o.length > 0 && o[o.length - 1]) || 6 !== i[0] && 2 !== i[0])) {\n                s = 0;\n                continue;\n              }\n\n              if (3 === i[0] && (!o || i[1] > o[0] && i[1] < o[3])) {\n                s.label = i[1];\n                break;\n              }\n\n              if (6 === i[0] && s.label < o[1]) {\n                s.label = o[1], o = i;\n                break;\n              }\n\n              if (o && s.label < o[2]) {\n                s.label = o[2], s.ops.push(i);\n                break;\n              }\n\n              o[2] && s.ops.pop(), s.trys.pop();\n              continue;\n          }\n\n          i = n.call(t, s);\n        } catch (t) {\n          i = [6, t], r = 0;\n        } finally {\n          e = o = 0;\n        }\n\n        if (5 & i[0]) throw i[1];\n        return {\n          value: i[0] ? i[1] : void 0,\n          done: !0\n        };\n      }([i, a]);\n    };\n  }\n}\n\nfunction w(t) {\n  return [Math.abs(t.endPoint[0] - t.startPoint[0]), Math.abs(t.endPoint[1] - t.startPoint[1])];\n}\n\nfunction L(t) {\n  return [t.startPoint[0] + (t.endPoint[0] - t.startPoint[0]) / 2, t.startPoint[1] + (t.endPoint[1] - t.startPoint[1]) / 2];\n}\n\nfunction B(t, n) {\n  void 0 === n && (n = 1.5);\n  var e = L(t),\n      r = w(t),\n      o = [n * r[0] / 2, n * r[1] / 2];\n  return {\n    startPoint: [e[0] - o[0], e[1] - o[1]],\n    endPoint: [e[0] + o[0], e[1] + o[1]],\n    palmLandmarks: t.palmLandmarks\n  };\n}\n\nfunction I(t) {\n  var n = L(t),\n      e = w(t),\n      r = Math.max.apply(Math, e) / 2;\n  return {\n    startPoint: [n[0] - r, n[1] - r],\n    endPoint: [n[0] + r, n[1] + r],\n    palmLandmarks: t.palmLandmarks\n  };\n}\n\nfunction C(t, n) {\n  var e = [t.endPoint[0] - t.startPoint[0], t.endPoint[1] - t.startPoint[1]],\n      r = [e[0] * n[0], e[1] * n[1]];\n  return {\n    startPoint: [t.startPoint[0] + r[0], t.startPoint[1] + r[1]],\n    endPoint: [t.endPoint[0] + r[0], t.endPoint[1] + r[1]],\n    palmLandmarks: t.palmLandmarks\n  };\n}\n\nvar H = function () {\n  function t(t, n, o, i, s, a) {\n    this.model = t, this.width = n, this.height = o, this.iouThreshold = s, this.scoreThreshold = a, this.anchors = i.map(function (t) {\n      return [t.x_center, t.y_center];\n    }), this.anchorsTensor = e(this.anchors), this.inputSizeTensor = r([n, o]), this.doubleInputSizeTensor = r([2 * n, 2 * o]);\n  }\n\n  return t.prototype.normalizeBoxes = function (t) {\n    var n = this;\n    return o(function () {\n      var e = i(t, [0, 0], [-1, 2]),\n          r = i(t, [0, 2], [-1, 2]),\n          o = s(a(e, n.inputSizeTensor), n.anchorsTensor),\n          c = a(r, n.doubleInputSizeTensor),\n          f = u(h(o, c), n.inputSizeTensor),\n          l = u(s(o, c), n.inputSizeTensor);\n      return d([f, l], 1);\n    });\n  }, t.prototype.normalizeLandmarks = function (t, n) {\n    var e = this;\n    return o(function () {\n      var r = s(a(c(t, [-1, 7, 2]), e.inputSizeTensor), e.anchors[n]);\n      return u(r, e.inputSizeTensor);\n    });\n  }, t.prototype.getBoundingBoxes = function (t) {\n    return y(this, void 0, void 0, function () {\n      var e,\n          r,\n          s,\n          a,\n          d,\n          v,\n          P,\n          g,\n          b,\n          k,\n          y,\n          w,\n          L,\n          B,\n          I,\n          C = this;\n      return x(this, function (x) {\n        switch (x.label) {\n          case 0:\n            return e = o(function () {\n              return u(h(t, .5), 2);\n            }), \"webgl\" === f() ? (s = l().get(\"WEBGL_PACK_DEPTHWISECONV\"), l().set(\"WEBGL_PACK_DEPTHWISECONV\", !0), r = this.model.predict(e), l().set(\"WEBGL_PACK_DEPTHWISECONV\", s)) : r = this.model.predict(e), a = p(r), d = o(function () {\n              return p(m(i(a, [0, 0], [-1, 1])));\n            }), v = i(a, [0, 1], [-1, 4]), P = this.normalizeBoxes(v), g = console.warn, console.warn = function () {}, b = n.nonMaxSuppression(P, d, 1, this.iouThreshold, this.scoreThreshold), console.warn = g, [4, b.array()];\n\n          case 1:\n            return k = x.sent(), y = [e, r, b, a, P, v, d], 0 === k.length ? (y.forEach(function (t) {\n              return t.dispose();\n            }), [2, null]) : (w = k[0], L = i(P, [w, 0], [1, -1]), B = i(a, [w, 5], [1, 14]), I = o(function () {\n              return c(C.normalizeLandmarks(B, w), [-1, 2]);\n            }), y.push(B), y.forEach(function (t) {\n              return t.dispose();\n            }), [2, {\n              boxes: L,\n              palmLandmarks: I\n            }]);\n        }\n      });\n    });\n  }, t.prototype.estimateHandBounds = function (t) {\n    return y(this, void 0, void 0, function () {\n      var e,\n          r,\n          i,\n          s,\n          u,\n          h,\n          d,\n          c,\n          f = this;\n      return x(this, function (l) {\n        switch (l.label) {\n          case 0:\n            return e = t.shape[1], r = t.shape[2], i = o(function () {\n              return a(n.resizeBilinear(t, [f.width, f.height]), 255);\n            }), [4, this.getBoundingBoxes(i)];\n\n          case 1:\n            return null === (s = l.sent()) ? (i.dispose(), [2, null]) : (u = s.boxes.arraySync(), h = u[0].slice(0, 2), d = u[0].slice(2, 4), c = s.palmLandmarks.arraySync(), i.dispose(), s.boxes.dispose(), s.palmLandmarks.dispose(), [2, (p = {\n              startPoint: h,\n              endPoint: d,\n              palmLandmarks: c\n            }, m = [r / this.width, e / this.height], {\n              startPoint: [p.startPoint[0] * m[0], p.startPoint[1] * m[1]],\n              endPoint: [p.endPoint[0] * m[0], p.endPoint[1] * m[1]],\n              palmLandmarks: p.palmLandmarks.map(function (t) {\n                return [t[0] * m[0], t[1] * m[1]];\n              })\n            })]);\n        }\n\n        var p, m;\n      });\n    });\n  }, t;\n}(),\n    M = {\n  thumb: [1, 2, 3, 4],\n  indexFinger: [5, 6, 7, 8],\n  middleFinger: [9, 10, 11, 12],\n  ringFinger: [13, 14, 15, 16],\n  pinky: [17, 18, 19, 20],\n  palmBase: [0]\n};\n\nfunction T(t, n) {\n  var e,\n      r = Math.PI / 2 - Math.atan2(-(n[1] - t[1]), n[0] - t[0]);\n  return (e = r) - 2 * Math.PI * Math.floor((e + Math.PI) / (2 * Math.PI));\n}\n\nvar E = function (t, n) {\n  return [[1, 0, t], [0, 1, n], [0, 0, 1]];\n};\n\nfunction O(t, n) {\n  for (var e = 0, r = 0; r < t.length; r++) e += t[r] * n[r];\n\n  return e;\n}\n\nfunction S(t, n) {\n  for (var e = [], r = 0; r < t.length; r++) e.push(t[r][n]);\n\n  return e;\n}\n\nfunction W(t, n) {\n  for (var e = [], r = t.length, o = 0; o < r; o++) {\n    e.push([]);\n\n    for (var i = 0; i < r; i++) e[o].push(O(t[o], S(n, i)));\n  }\n\n  return e;\n}\n\nfunction D(t, n) {\n  var e = Math.cos(t),\n      r = Math.sin(t),\n      o = [[e, -r, 0], [r, e, 0], [0, 0, 1]],\n      i = W(E(n[0], n[1]), o);\n  return W(i, E(-n[0], -n[1]));\n}\n\nfunction z(t, n) {\n  return [O(t, n[0]), O(t, n[1])];\n}\n\nvar _ = [0, -.4],\n    R = [0, -.1],\n    j = [0, 5, 9, 13, 17, 1, 2],\n    V = function () {\n  function t(t, n, e, r, o, i) {\n    this.boundingBoxDetector = t, this.meshDetector = n, this.meshWidth = e, this.meshHeight = r, this.maxContinuousChecks = o, this.detectionConfidence = i, this.regionsOfInterest = [], this.runsWithoutHandDetector = 0, this.maxHandsNumber = 1;\n  }\n\n  return t.prototype.getBoxForPalmLandmarks = function (t, n) {\n    var e = t.map(function (t) {\n      return z(t.concat([1]), n);\n    });\n    return B(I(C(this.calculateLandmarksBoundingBox(e), _)), 3);\n  }, t.prototype.getBoxForHandLandmarks = function (t) {\n    for (var n = B(I(C(this.calculateLandmarksBoundingBox(t), R)), 1.65), e = [], r = 0; r < j.length; r++) e.push(t[j[r]].slice(0, 2));\n\n    return n.palmLandmarks = e, n;\n  }, t.prototype.transformRawCoords = function (t, n, e, r) {\n    var o,\n        i,\n        s,\n        a,\n        u = this,\n        h = w(n),\n        d = [h[0] / this.meshWidth, h[1] / this.meshHeight],\n        c = t.map(function (t) {\n      return [d[0] * (t[0] - u.meshWidth / 2), d[1] * (t[1] - u.meshHeight / 2), t[2]];\n    }),\n        f = D(e, [0, 0]),\n        l = c.map(function (t) {\n      return z(t, f).concat([t[2]]);\n    }),\n        p = (i = [[(o = r)[0][0], o[1][0]], [o[0][1], o[1][1]]], s = [o[0][2], o[1][2]], a = [-O(i[0], s), -O(i[1], s)], [i[0].concat(a[0]), i[1].concat(a[1]), [0, 0, 1]]),\n        m = L(n).concat([1]),\n        v = [O(m, p[0]), O(m, p[1])];\n    return l.map(function (t) {\n      return [t[0] + v[0], t[1] + v[1], t[2]];\n    });\n  }, t.prototype.estimateHand = function (t) {\n    return y(this, void 0, void 0, function () {\n      var e, r, o, i, s, u, h, d, p, m, v, P, g, b, k, y, w, B, I, C;\n      return x(this, function (x) {\n        switch (x.label) {\n          case 0:\n            return !0 !== (e = this.shouldUpdateRegionsOfInterest()) ? [3, 2] : [4, this.boundingBoxDetector.estimateHandBounds(t)];\n\n          case 1:\n            return null === (r = x.sent()) ? (t.dispose(), this.regionsOfInterest = [], [2, null]) : (this.updateRegionsOfInterest(r, !0), this.runsWithoutHandDetector = 0, [3, 3]);\n\n          case 2:\n            this.runsWithoutHandDetector++, x.label = 3;\n\n          case 3:\n            return o = this.regionsOfInterest[0], i = T(o.palmLandmarks[0], o.palmLandmarks[2]), s = L(o), u = [s[0] / t.shape[2], s[1] / t.shape[1]], h = n.rotateWithOffset(t, i, 0, u), d = D(-i, s), p = !0 === e ? this.getBoxForPalmLandmarks(o.palmLandmarks, d) : o, m = function (t, e, r) {\n              var o = e.shape[1],\n                  i = e.shape[2],\n                  s = [[t.startPoint[1] / o, t.startPoint[0] / i, t.endPoint[1] / o, t.endPoint[0] / i]];\n              return n.cropAndResize(e, s, [0], r);\n            }(p, h, [this.meshWidth, this.meshHeight]), v = a(m, 255), m.dispose(), h.dispose(), \"webgl\" === f() ? (g = l().get(\"WEBGL_PACK_DEPTHWISECONV\"), l().set(\"WEBGL_PACK_DEPTHWISECONV\", !0), P = this.meshDetector.predict(v), l().set(\"WEBGL_PACK_DEPTHWISECONV\", g)) : P = this.meshDetector.predict(v), b = P[0], k = P[1], v.dispose(), y = b.dataSync()[0], b.dispose(), y < this.detectionConfidence ? (k.dispose(), this.regionsOfInterest = [], [2, null]) : (w = c(k, [-1, 3]), B = w.arraySync(), k.dispose(), w.dispose(), I = this.transformRawCoords(B, p, i, d), C = this.getBoxForHandLandmarks(I), this.updateRegionsOfInterest(C, !1), [2, {\n              landmarks: I,\n              handInViewConfidence: y,\n              boundingBox: {\n                topLeft: C.startPoint,\n                bottomRight: C.endPoint\n              }\n            }]);\n        }\n      });\n    });\n  }, t.prototype.calculateLandmarksBoundingBox = function (t) {\n    var n = t.map(function (t) {\n      return t[0];\n    }),\n        e = t.map(function (t) {\n      return t[1];\n    });\n    return {\n      startPoint: [Math.min.apply(Math, n), Math.min.apply(Math, e)],\n      endPoint: [Math.max.apply(Math, n), Math.max.apply(Math, e)]\n    };\n  }, t.prototype.updateRegionsOfInterest = function (t, n) {\n    if (n) this.regionsOfInterest = [t];else {\n      var e = this.regionsOfInterest[0],\n          r = 0;\n\n      if (null != e && null != e.startPoint) {\n        var o = t.startPoint,\n            i = o[0],\n            s = o[1],\n            a = t.endPoint,\n            u = a[0],\n            h = a[1],\n            d = e.startPoint,\n            c = d[0],\n            f = d[1],\n            l = e.endPoint,\n            p = l[0],\n            m = l[1],\n            v = Math.max(i, c),\n            P = Math.max(s, f),\n            g = (Math.min(u, p) - v) * (Math.min(h, m) - P);\n        r = g / ((u - i) * (h - s) + (p - c) * (m - s) - g);\n      }\n\n      this.regionsOfInterest[0] = r > .8 ? e : t;\n    }\n  }, t.prototype.shouldUpdateRegionsOfInterest = function () {\n    return this.regionsOfInterest.length !== this.maxHandsNumber || this.runsWithoutHandDetector >= this.maxContinuousChecks;\n  }, t;\n}();\n\nfunction F() {\n  return y(this, void 0, void 0, function () {\n    return x(this, function (n) {\n      return \"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\", [2, t(\"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\", {\n        fromTFHub: !0\n      })];\n    });\n  });\n}\n\nfunction A() {\n  return y(this, void 0, void 0, function () {\n    return x(this, function (n) {\n      return \"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\", [2, t(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\", {\n        fromTFHub: !0\n      })];\n    });\n  });\n}\n\nfunction N() {\n  return y(this, void 0, void 0, function () {\n    return x(this, function (t) {\n      return [2, v.fetch(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file\").then(function (t) {\n        return t.json();\n      })];\n    });\n  });\n}\n\nfunction G(t) {\n  var n = void 0 === t ? {} : t,\n      e = n.maxContinuousChecks,\n      r = void 0 === e ? 1 / 0 : e,\n      o = n.detectionConfidence,\n      i = void 0 === o ? .8 : o,\n      s = n.iouThreshold,\n      a = void 0 === s ? .3 : s,\n      u = n.scoreThreshold,\n      h = void 0 === u ? .5 : u;\n  return y(this, void 0, void 0, function () {\n    var t, n, e, o, s, u;\n    return x(this, function (d) {\n      switch (d.label) {\n        case 0:\n          return [4, Promise.all([N(), F(), A()])];\n\n        case 1:\n          return t = d.sent(), n = t[0], e = t[1], o = t[2], s = new H(e, 256, 256, n, a, h), u = new V(s, o, 256, 256, r, i), [2, new K(u)];\n      }\n    });\n  });\n}\n\nvar K = function () {\n  function t(t) {\n    this.pipeline = t;\n  }\n\n  return t.getAnnotations = function () {\n    return M;\n  }, t.prototype.estimateHands = function (t, n) {\n    return void 0 === n && (n = !1), y(this, void 0, void 0, function () {\n      var e, r, i, s, a, u, h, d, c;\n      return x(this, function (f) {\n        switch (f.label) {\n          case 0:\n            return e = function (t) {\n              return t instanceof P ? [t.shape[0], t.shape[1]] : [t.height, t.width];\n            }(t), r = e[1], i = o(function () {\n              return t instanceof P || (t = g.fromPixels(t)), b(k(t, \"float32\"));\n            }), [4, this.pipeline.estimateHand(i)];\n\n          case 1:\n            if (s = f.sent(), i.dispose(), null === s) return [2, []];\n\n            for (a = s, !0 === n && (a = function (t, n) {\n              var e = t.handInViewConfidence,\n                  r = t.landmarks,\n                  o = t.boundingBox;\n              return {\n                handInViewConfidence: e,\n                landmarks: r.map(function (t) {\n                  return [n - 1 - t[0], t[1], t[2]];\n                }),\n                boundingBox: {\n                  topLeft: [n - 1 - o.topLeft[0], o.topLeft[1]],\n                  bottomRight: [n - 1 - o.bottomRight[0], o.bottomRight[1]]\n                }\n              };\n            }(s, r)), u = {}, h = 0, d = Object.keys(M); h < d.length; h++) c = d[h], u[c] = M[c].map(function (t) {\n              return a.landmarks[t];\n            });\n\n            return [2, [{\n              handInViewConfidence: a.handInViewConfidence,\n              boundingBox: a.boundingBox,\n              landmarks: a.landmarks,\n              annotations: u\n            }]];\n        }\n      });\n    });\n  }, t;\n}();\n\nexport { K as HandPose, G as load };","map":{"version":3,"sources":["/Users/shubhamkapoor/gather-video-chat/server/client/node_modules/@tensorflow-models/handpose/dist/handpose.esm.js"],"names":["loadGraphModel","t","image","n","tensor2d","e","tensor1d","r","tidy","o","slice","i","add","s","div","a","mul","u","sub","h","concat2d","d","reshape","c","getBackend","f","env","l","squeeze","p","sigmoid","m","util","v","Tensor","P","browser","g","expandDims","b","cast","k","y","Promise","next","throw","done","value","then","apply","x","label","sent","trys","ops","return","Symbol","iterator","TypeError","call","pop","length","push","w","Math","abs","endPoint","startPoint","L","B","palmLandmarks","I","max","C","H","model","width","height","iouThreshold","scoreThreshold","anchors","map","x_center","y_center","anchorsTensor","inputSizeTensor","doubleInputSizeTensor","prototype","normalizeBoxes","normalizeLandmarks","getBoundingBoxes","get","set","predict","console","warn","nonMaxSuppression","array","forEach","dispose","boxes","estimateHandBounds","shape","resizeBilinear","arraySync","M","thumb","indexFinger","middleFinger","ringFinger","pinky","palmBase","T","PI","atan2","floor","E","O","S","W","D","cos","sin","z","_","R","j","V","boundingBoxDetector","meshDetector","meshWidth","meshHeight","maxContinuousChecks","detectionConfidence","regionsOfInterest","runsWithoutHandDetector","maxHandsNumber","getBoxForPalmLandmarks","concat","calculateLandmarksBoundingBox","getBoxForHandLandmarks","transformRawCoords","estimateHand","shouldUpdateRegionsOfInterest","updateRegionsOfInterest","rotateWithOffset","cropAndResize","dataSync","landmarks","handInViewConfidence","boundingBox","topLeft","bottomRight","min","F","fromTFHub","A","N","fetch","json","G","all","K","pipeline","getAnnotations","estimateHands","fromPixels","Object","keys","annotations","HandPose","load"],"mappings":"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","sourcesContent":["/**\n    * @license\n    * Copyright 2021 Google LLC. All Rights Reserved.\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\n    * you may not use this file except in compliance with the License.\n    * You may obtain a copy of the License at\n    *\n    * http://www.apache.org/licenses/LICENSE-2.0\n    *\n    * Unless required by applicable law or agreed to in writing, software\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    * See the License for the specific language governing permissions and\n    * limitations under the License.\n    * =============================================================================\n    */\nimport{loadGraphModel as t}from\"@tensorflow/tfjs-converter\";import{image as n,tensor2d as e,tensor1d as r,tidy as o,slice as i,add as s,div as a,mul as u,sub as h,concat2d as d,reshape as c,getBackend as f,env as l,squeeze as p,sigmoid as m,util as v,Tensor as P,browser as g,expandDims as b,cast as k}from\"@tensorflow/tfjs-core\";function y(t,n,e,r){return new(e||(e=Promise))((function(o,i){function s(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(s,a)}u((r=r.apply(t,n||[])).next())}))}function x(t,n){var e,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(e)throw new TypeError(\"Generator is already executing.\");for(;s;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=n.call(t,s)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function w(t){return[Math.abs(t.endPoint[0]-t.startPoint[0]),Math.abs(t.endPoint[1]-t.startPoint[1])]}function L(t){return[t.startPoint[0]+(t.endPoint[0]-t.startPoint[0])/2,t.startPoint[1]+(t.endPoint[1]-t.startPoint[1])/2]}function B(t,n){void 0===n&&(n=1.5);var e=L(t),r=w(t),o=[n*r[0]/2,n*r[1]/2];return{startPoint:[e[0]-o[0],e[1]-o[1]],endPoint:[e[0]+o[0],e[1]+o[1]],palmLandmarks:t.palmLandmarks}}function I(t){var n=L(t),e=w(t),r=Math.max.apply(Math,e)/2;return{startPoint:[n[0]-r,n[1]-r],endPoint:[n[0]+r,n[1]+r],palmLandmarks:t.palmLandmarks}}function C(t,n){var e=[t.endPoint[0]-t.startPoint[0],t.endPoint[1]-t.startPoint[1]],r=[e[0]*n[0],e[1]*n[1]];return{startPoint:[t.startPoint[0]+r[0],t.startPoint[1]+r[1]],endPoint:[t.endPoint[0]+r[0],t.endPoint[1]+r[1]],palmLandmarks:t.palmLandmarks}}var H=function(){function t(t,n,o,i,s,a){this.model=t,this.width=n,this.height=o,this.iouThreshold=s,this.scoreThreshold=a,this.anchors=i.map((function(t){return[t.x_center,t.y_center]})),this.anchorsTensor=e(this.anchors),this.inputSizeTensor=r([n,o]),this.doubleInputSizeTensor=r([2*n,2*o])}return t.prototype.normalizeBoxes=function(t){var n=this;return o((function(){var e=i(t,[0,0],[-1,2]),r=i(t,[0,2],[-1,2]),o=s(a(e,n.inputSizeTensor),n.anchorsTensor),c=a(r,n.doubleInputSizeTensor),f=u(h(o,c),n.inputSizeTensor),l=u(s(o,c),n.inputSizeTensor);return d([f,l],1)}))},t.prototype.normalizeLandmarks=function(t,n){var e=this;return o((function(){var r=s(a(c(t,[-1,7,2]),e.inputSizeTensor),e.anchors[n]);return u(r,e.inputSizeTensor)}))},t.prototype.getBoundingBoxes=function(t){return y(this,void 0,void 0,(function(){var e,r,s,a,d,v,P,g,b,k,y,w,L,B,I,C=this;return x(this,(function(x){switch(x.label){case 0:return e=o((function(){return u(h(t,.5),2)})),\"webgl\"===f()?(s=l().get(\"WEBGL_PACK_DEPTHWISECONV\"),l().set(\"WEBGL_PACK_DEPTHWISECONV\",!0),r=this.model.predict(e),l().set(\"WEBGL_PACK_DEPTHWISECONV\",s)):r=this.model.predict(e),a=p(r),d=o((function(){return p(m(i(a,[0,0],[-1,1])))})),v=i(a,[0,1],[-1,4]),P=this.normalizeBoxes(v),g=console.warn,console.warn=function(){},b=n.nonMaxSuppression(P,d,1,this.iouThreshold,this.scoreThreshold),console.warn=g,[4,b.array()];case 1:return k=x.sent(),y=[e,r,b,a,P,v,d],0===k.length?(y.forEach((function(t){return t.dispose()})),[2,null]):(w=k[0],L=i(P,[w,0],[1,-1]),B=i(a,[w,5],[1,14]),I=o((function(){return c(C.normalizeLandmarks(B,w),[-1,2])})),y.push(B),y.forEach((function(t){return t.dispose()})),[2,{boxes:L,palmLandmarks:I}])}}))}))},t.prototype.estimateHandBounds=function(t){return y(this,void 0,void 0,(function(){var e,r,i,s,u,h,d,c,f=this;return x(this,(function(l){switch(l.label){case 0:return e=t.shape[1],r=t.shape[2],i=o((function(){return a(n.resizeBilinear(t,[f.width,f.height]),255)})),[4,this.getBoundingBoxes(i)];case 1:return null===(s=l.sent())?(i.dispose(),[2,null]):(u=s.boxes.arraySync(),h=u[0].slice(0,2),d=u[0].slice(2,4),c=s.palmLandmarks.arraySync(),i.dispose(),s.boxes.dispose(),s.palmLandmarks.dispose(),[2,(p={startPoint:h,endPoint:d,palmLandmarks:c},m=[r/this.width,e/this.height],{startPoint:[p.startPoint[0]*m[0],p.startPoint[1]*m[1]],endPoint:[p.endPoint[0]*m[0],p.endPoint[1]*m[1]],palmLandmarks:p.palmLandmarks.map((function(t){return[t[0]*m[0],t[1]*m[1]]}))})])}var p,m}))}))},t}(),M={thumb:[1,2,3,4],indexFinger:[5,6,7,8],middleFinger:[9,10,11,12],ringFinger:[13,14,15,16],pinky:[17,18,19,20],palmBase:[0]};function T(t,n){var e,r=Math.PI/2-Math.atan2(-(n[1]-t[1]),n[0]-t[0]);return(e=r)-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}var E=function(t,n){return[[1,0,t],[0,1,n],[0,0,1]]};function O(t,n){for(var e=0,r=0;r<t.length;r++)e+=t[r]*n[r];return e}function S(t,n){for(var e=[],r=0;r<t.length;r++)e.push(t[r][n]);return e}function W(t,n){for(var e=[],r=t.length,o=0;o<r;o++){e.push([]);for(var i=0;i<r;i++)e[o].push(O(t[o],S(n,i)))}return e}function D(t,n){var e=Math.cos(t),r=Math.sin(t),o=[[e,-r,0],[r,e,0],[0,0,1]],i=W(E(n[0],n[1]),o);return W(i,E(-n[0],-n[1]))}function z(t,n){return[O(t,n[0]),O(t,n[1])]}var _=[0,-.4],R=[0,-.1],j=[0,5,9,13,17,1,2],V=function(){function t(t,n,e,r,o,i){this.boundingBoxDetector=t,this.meshDetector=n,this.meshWidth=e,this.meshHeight=r,this.maxContinuousChecks=o,this.detectionConfidence=i,this.regionsOfInterest=[],this.runsWithoutHandDetector=0,this.maxHandsNumber=1}return t.prototype.getBoxForPalmLandmarks=function(t,n){var e=t.map((function(t){return z(t.concat([1]),n)}));return B(I(C(this.calculateLandmarksBoundingBox(e),_)),3)},t.prototype.getBoxForHandLandmarks=function(t){for(var n=B(I(C(this.calculateLandmarksBoundingBox(t),R)),1.65),e=[],r=0;r<j.length;r++)e.push(t[j[r]].slice(0,2));return n.palmLandmarks=e,n},t.prototype.transformRawCoords=function(t,n,e,r){var o,i,s,a,u=this,h=w(n),d=[h[0]/this.meshWidth,h[1]/this.meshHeight],c=t.map((function(t){return[d[0]*(t[0]-u.meshWidth/2),d[1]*(t[1]-u.meshHeight/2),t[2]]})),f=D(e,[0,0]),l=c.map((function(t){return z(t,f).concat([t[2]])})),p=(i=[[(o=r)[0][0],o[1][0]],[o[0][1],o[1][1]]],s=[o[0][2],o[1][2]],a=[-O(i[0],s),-O(i[1],s)],[i[0].concat(a[0]),i[1].concat(a[1]),[0,0,1]]),m=L(n).concat([1]),v=[O(m,p[0]),O(m,p[1])];return l.map((function(t){return[t[0]+v[0],t[1]+v[1],t[2]]}))},t.prototype.estimateHand=function(t){return y(this,void 0,void 0,(function(){var e,r,o,i,s,u,h,d,p,m,v,P,g,b,k,y,w,B,I,C;return x(this,(function(x){switch(x.label){case 0:return!0!==(e=this.shouldUpdateRegionsOfInterest())?[3,2]:[4,this.boundingBoxDetector.estimateHandBounds(t)];case 1:return null===(r=x.sent())?(t.dispose(),this.regionsOfInterest=[],[2,null]):(this.updateRegionsOfInterest(r,!0),this.runsWithoutHandDetector=0,[3,3]);case 2:this.runsWithoutHandDetector++,x.label=3;case 3:return o=this.regionsOfInterest[0],i=T(o.palmLandmarks[0],o.palmLandmarks[2]),s=L(o),u=[s[0]/t.shape[2],s[1]/t.shape[1]],h=n.rotateWithOffset(t,i,0,u),d=D(-i,s),p=!0===e?this.getBoxForPalmLandmarks(o.palmLandmarks,d):o,m=function(t,e,r){var o=e.shape[1],i=e.shape[2],s=[[t.startPoint[1]/o,t.startPoint[0]/i,t.endPoint[1]/o,t.endPoint[0]/i]];return n.cropAndResize(e,s,[0],r)}(p,h,[this.meshWidth,this.meshHeight]),v=a(m,255),m.dispose(),h.dispose(),\"webgl\"===f()?(g=l().get(\"WEBGL_PACK_DEPTHWISECONV\"),l().set(\"WEBGL_PACK_DEPTHWISECONV\",!0),P=this.meshDetector.predict(v),l().set(\"WEBGL_PACK_DEPTHWISECONV\",g)):P=this.meshDetector.predict(v),b=P[0],k=P[1],v.dispose(),y=b.dataSync()[0],b.dispose(),y<this.detectionConfidence?(k.dispose(),this.regionsOfInterest=[],[2,null]):(w=c(k,[-1,3]),B=w.arraySync(),k.dispose(),w.dispose(),I=this.transformRawCoords(B,p,i,d),C=this.getBoxForHandLandmarks(I),this.updateRegionsOfInterest(C,!1),[2,{landmarks:I,handInViewConfidence:y,boundingBox:{topLeft:C.startPoint,bottomRight:C.endPoint}}])}}))}))},t.prototype.calculateLandmarksBoundingBox=function(t){var n=t.map((function(t){return t[0]})),e=t.map((function(t){return t[1]}));return{startPoint:[Math.min.apply(Math,n),Math.min.apply(Math,e)],endPoint:[Math.max.apply(Math,n),Math.max.apply(Math,e)]}},t.prototype.updateRegionsOfInterest=function(t,n){if(n)this.regionsOfInterest=[t];else{var e=this.regionsOfInterest[0],r=0;if(null!=e&&null!=e.startPoint){var o=t.startPoint,i=o[0],s=o[1],a=t.endPoint,u=a[0],h=a[1],d=e.startPoint,c=d[0],f=d[1],l=e.endPoint,p=l[0],m=l[1],v=Math.max(i,c),P=Math.max(s,f),g=(Math.min(u,p)-v)*(Math.min(h,m)-P);r=g/((u-i)*(h-s)+(p-c)*(m-s)-g)}this.regionsOfInterest[0]=r>.8?e:t}},t.prototype.shouldUpdateRegionsOfInterest=function(){return this.regionsOfInterest.length!==this.maxHandsNumber||this.runsWithoutHandDetector>=this.maxContinuousChecks},t}();function F(){return y(this,void 0,void 0,(function(){return x(this,(function(n){return\"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\",[2,t(\"https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1\",{fromTFHub:!0})]}))}))}function A(){return y(this,void 0,void 0,(function(){return x(this,(function(n){return\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\",[2,t(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1\",{fromTFHub:!0})]}))}))}function N(){return y(this,void 0,void 0,(function(){return x(this,(function(t){return[2,v.fetch(\"https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file\").then((function(t){return t.json()}))]}))}))}function G(t){var n=void 0===t?{}:t,e=n.maxContinuousChecks,r=void 0===e?1/0:e,o=n.detectionConfidence,i=void 0===o?.8:o,s=n.iouThreshold,a=void 0===s?.3:s,u=n.scoreThreshold,h=void 0===u?.5:u;return y(this,void 0,void 0,(function(){var t,n,e,o,s,u;return x(this,(function(d){switch(d.label){case 0:return[4,Promise.all([N(),F(),A()])];case 1:return t=d.sent(),n=t[0],e=t[1],o=t[2],s=new H(e,256,256,n,a,h),u=new V(s,o,256,256,r,i),[2,new K(u)]}}))}))}var K=function(){function t(t){this.pipeline=t}return t.getAnnotations=function(){return M},t.prototype.estimateHands=function(t,n){return void 0===n&&(n=!1),y(this,void 0,void 0,(function(){var e,r,i,s,a,u,h,d,c;return x(this,(function(f){switch(f.label){case 0:return e=function(t){return t instanceof P?[t.shape[0],t.shape[1]]:[t.height,t.width]}(t),r=e[1],i=o((function(){return t instanceof P||(t=g.fromPixels(t)),b(k(t,\"float32\"))})),[4,this.pipeline.estimateHand(i)];case 1:if(s=f.sent(),i.dispose(),null===s)return[2,[]];for(a=s,!0===n&&(a=function(t,n){var e=t.handInViewConfidence,r=t.landmarks,o=t.boundingBox;return{handInViewConfidence:e,landmarks:r.map((function(t){return[n-1-t[0],t[1],t[2]]})),boundingBox:{topLeft:[n-1-o.topLeft[0],o.topLeft[1]],bottomRight:[n-1-o.bottomRight[0],o.bottomRight[1]]}}}(s,r)),u={},h=0,d=Object.keys(M);h<d.length;h++)c=d[h],u[c]=M[c].map((function(t){return a.landmarks[t]}));return[2,[{handInViewConfidence:a.handInViewConfidence,boundingBox:a.boundingBox,landmarks:a.landmarks,annotations:u}]]}}))}))},t}();export{K as HandPose,G as load};\n"]},"metadata":{},"sourceType":"module"}