/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
import * as tf from '../../index';
import { ALL_ENVS, describeWithFlags } from '../../jasmine_util';
import { expectArraysClose } from '../../test_util';
describeWithFlags('sparseFillEmptyRows', ALL_ENVS, () => {
    it('fill number', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[0, 0], [1, 0], [1, 3], [1, 4], [3, 2], [3, 3]], [6, 2], 'int32'),
            val: [0, 10, 13, 14, 32, 33],
            shape: [5, 6],
        };
        const result = tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1);
        expectArraysClose(await result.outputIndices.data(), [[0, 0], [1, 0], [1, 3], [1, 4], [2, 0], [3, 2], [3, 3], [4, 0]]);
        expectArraysClose(await result.outputValues.data(), [0, 10, 13, 14, -1, 32, 33, -1]);
        expectArraysClose(await result.emptyRowIndicator.data(), [0, 0, 1, 0, 1]);
        expectArraysClose(await result.reverseIndexMap.data(), [0, 1, 2, 3, 5, 6]);
    });
    it('fill float', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[0, 0], [1, 0], [1, 3], [1, 4], [3, 2], [3, 3]], [6, 2], 'float32'),
            val: [0.0, 10.0, 13.0, 14.0, 32.0, 33.0],
            shape: [5, 6],
        };
        const result = tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1);
        expectArraysClose(await result.outputIndices.data(), [[0, 0], [1, 0], [1, 3], [1, 4], [2, 0], [3, 2], [3, 3], [4, 0]]);
        expectArraysClose(await result.outputValues.data(), [0, 10, 13, 14, -1, 32, 33, -1]);
        expectArraysClose(await result.emptyRowIndicator.data(), [0, 0, 1, 0, 1]);
        expectArraysClose(await result.reverseIndexMap.data(), [0, 1, 2, 3, 5, 6]);
    });
    it('no empty rows', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[0, 0], [1, 0], [1, 3], [1, 4]], [4, 2], 'int32'),
            val: [0, 10, 13, 14],
            shape: [2, 6],
        };
        const result = tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1);
        expectArraysClose(await result.outputIndices.data(), [[0, 0], [1, 0], [1, 3], [1, 4]]);
        expectArraysClose(await result.outputValues.data(), [0, 10, 13, 14]);
        expectArraysClose(await result.emptyRowIndicator.data(), [0, 0]);
        expectArraysClose(await result.reverseIndexMap.data(), [0, 1, 2, 3]);
    });
    it('no empty rows and unordered', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[1, 2], [1, 3], [0, 1], [0, 3]], [4, 2], 'float32'),
            val: [1, 3, 2, 4],
            shape: [2, 5],
        };
        const result = tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1);
        expectArraysClose(await result.outputIndices.data(), [[0, 1], [0, 3], [1, 2], [1, 3]]);
        expectArraysClose(await result.outputValues.data(), [2, 4, 1, 3]);
        expectArraysClose(await result.emptyRowIndicator.data(), [0, 0]);
        expectArraysClose(await result.reverseIndexMap.data(), [2, 3, 0, 1]);
    });
    it('no rows', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([], [0, 2], 'int32'),
            val: [],
            shape: [0, 5],
        };
        const result = tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1);
        expectArraysClose(await result.outputIndices.data(), []);
        expectArraysClose(await result.outputValues.data(), []);
        expectArraysClose(await result.emptyRowIndicator.data(), []);
        expectArraysClose(await result.reverseIndexMap.data(), []);
    });
    it('check output metadata', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[0, 0], [1, 0], [1, 3], [1, 4], [3, 2], [3, 3]], [6, 2], 'int32'),
            val: tf.tensor1d([0, 10, 13, 14, 32, 33], 'float32'),
            shape: [5, 6],
        };
        const result = tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1);
        expectArraysClose(await result.outputIndices.data(), [[0, 0], [1, 0], [1, 3], [1, 4], [2, 0], [3, 2], [3, 3], [4, 0]]);
        expectArraysClose(await result.outputValues.data(), [0, 10, 13, 14, -1, 32, 33, -1]);
        expectArraysClose(await result.emptyRowIndicator.data(), [0, 0, 1, 0, 1]);
        expectArraysClose(await result.reverseIndexMap.data(), [0, 1, 2, 3, 5, 6]);
        expect(result.outputIndices.shape).toEqual([8, 2]);
        expect(result.outputValues.shape).toEqual([8]);
        expect(result.emptyRowIndicator.shape).toEqual([5]);
        expect(result.reverseIndexMap.shape).toEqual([6]);
        expect(result.outputIndices.dtype).toEqual(sparseTensor.ind.dtype);
        expect(result.outputValues.dtype).toEqual(sparseTensor.val.dtype);
        expect(result.emptyRowIndicator.dtype).toEqual('bool');
        expect(result.reverseIndexMap.dtype).toEqual(sparseTensor.ind.dtype);
    });
    it('throw error if dense rows is empty and indices is not', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[0, 0]], [1, 2], 'int32'),
            val: [1],
            shape: [0, 5],
        };
        expect(() => tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1))
            .toThrowError(/indices\.shape\[0\] = 1/);
    });
    it('throw error if negative row', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[-1, 0]], [1, 2], 'int32'),
            val: [1],
            shape: [5, 5],
        };
        expect(() => tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1))
            .toThrowError('indices(0, 0) is invalid: -1 < 0');
    });
    it('throw error if row exceeds number of dense rows', async () => {
        const sparseTensor = {
            ind: tf.tensor2d([[5, 0]], [1, 2], 'int32'),
            val: [1],
            shape: [5, 5],
        };
        expect(() => tf.sparse.sparseFillEmptyRows(sparseTensor.ind, sparseTensor.val, sparseTensor.shape, -1))
            .toThrowError('indices(0, 0) is invalid: 5 >= 5');
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BhcnNlX2ZpbGxfZW1wdHlfcm93c190ZXN0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vdGZqcy1jb3JlL3NyYy9vcHMvc3BhcnNlL3NwYXJzZV9maWxsX2VtcHR5X3Jvd3NfdGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7O0dBZUc7QUFFSCxPQUFPLEtBQUssRUFBRSxNQUFNLGFBQWEsQ0FBQztBQUNsQyxPQUFPLEVBQUMsUUFBUSxFQUFFLGlCQUFpQixFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFDL0QsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFFbEQsaUJBQWlCLENBQUMscUJBQXFCLEVBQUUsUUFBUSxFQUFFLEdBQUcsRUFBRTtJQUN0RCxFQUFFLENBQUMsYUFBYSxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzNCLE1BQU0sWUFBWSxHQUFHO1lBQ25CLEdBQUcsRUFBRSxFQUFFLENBQUMsUUFBUSxDQUNaLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxPQUFPLENBQUM7WUFDdEUsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLENBQUM7WUFDNUIsS0FBSyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNkLENBQUM7UUFDRixNQUFNLE1BQU0sR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLG1CQUFtQixD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QyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxPQUFPLENBQUM7WUFDM0MsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ1IsS0FBSyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQztTQUNkLENBQUM7UUFDRixNQUFNLENBQ0YsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUIsQ0FDL0IsWUFBWSxDQUFDLEdBQUcsRUFBRSxZQUFZLENBQUMsR0FBRyxFQUFFLFlBQVksQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQzthQUMvRCxZQUFZLENBQUMsa0NBQWtDLENBQUMsQ0FBQztJQUN4RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjEgR29vZ2xlIExMQy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqL1xuXG5pbXBvcnQgKiBhcyB0ZiBmcm9tICcuLi8uLi9pbmRleCc7XG5pbXBvcnQge0FMTF9FTlZTLCBkZXNjcmliZVdpdGhGbGFnc30gZnJvbSAnLi4vLi4vamFzbWluZV91dGlsJztcbmltcG9ydCB7ZXhwZWN0QXJyYXlzQ2xvc2V9IGZyb20gJy4uLy4uL3Rlc3RfdXRpbCc7XG5cbmRlc2NyaWJlV2l0aEZsYWdzKCdzcGFyc2VGaWxsRW1wdHlSb3dzJywgQUxMX0VOVlMsICgpID0+IHtcbiAgaXQoJ2ZpbGwgbnVtYmVyJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHNwYXJzZVRlbnNvciA9IHtcbiAgICAgIGluZDogdGYudGVuc29yMmQoXG4gICAgICAgICAgW1swLCAwXSwgWzEsIDBdLCBbMSwgM10sIFsxLCA0XSwgWzMsIDJdLCBbMywgM11dLCBbNiwgMl0sICdpbnQzMicpLFxuICAgICAgdmFsOiBbMCwgMTAsIDEzLCAxNCwgMzIsIDMzXSxcbiAgICAgIHNoYXBlOiBbNSwgNl0sXG4gICAgfTtcbiAgICBjb25zdCByZXN1bHQgPSB0Zi5zcGFyc2Uuc3BhcnNlRmlsbEVtcHR5Um93cyhcbiAgICAgICAgc3BhcnNlVGVuc29yLmluZCwgc3BhcnNlVGVuc29yLnZhbCwgc3BhcnNlVGVuc29yLnNoYXBlLCAtMSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoXG4gICAgICAgIGF3YWl0IHJlc3VsdC5vdXRwdXRJbmRpY2VzLmRhdGEoKSxcbiAgICAgICAgW1swLCAwXSwgWzEsIDBdLCBbMSwgM10sIFsxLCA0XSwgWzIsIDBdLCBbMywgMl0sIFszLCAzXSwgWzQsIDBdXSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoXG4gICAgICAgIGF3YWl0IHJlc3VsdC5vdXRwdXRWYWx1ZXMuZGF0YSgpLCBbMCwgMTAsIDEzLCAxNCwgLTEsIDMyLCAzMywgLTFdKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShhd2FpdCByZXN1bHQuZW1wdHlSb3dJbmRpY2F0b3IuZGF0YSgpLCBbMCwgMCwgMSwgMCwgMV0pO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKGF3YWl0IHJlc3VsdC5yZXZlcnNlSW5kZXhNYXAuZGF0YSgpLCBbMCwgMSwgMiwgMywgNSwgNl0pO1xuICB9KTtcblxuICBpdCgnZmlsbCBmbG9hdCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBzcGFyc2VUZW5zb3IgPSB7XG4gICAgICBpbmQ6IHRmLnRlbnNvcjJkKFxuICAgICAgICAgIFtbMCwgMF0sIFsxLCAwXSwgWzEsIDNdLCBbMSwgNF0sIFszLCAyXSwgWzMsIDNdXSwgWzYsIDJdLCAnZmxvYXQzMicpLFxuICAgICAgdmFsOiBbMC4wLCAxMC4wLCAxMy4wLCAxNC4wLCAzMi4wLCAzMy4wXSxcbiAgICAgIHNoYXBlOiBbNSwgNl0sXG4gICAgfTtcbiAgICBjb25zdCByZXN1bHQgPSB0Zi5zcGFyc2Uuc3BhcnNlRmlsbEVtcHR5Um93cyhcbiAgICAgICAgc3BhcnNlVGVuc29yLmluZCwgc3BhcnNlVGVuc29yLnZhbCwgc3BhcnNlVGVuc29yLnNoYXBlLCAtMSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoXG4gICAgICAgIGF3YWl0IHJlc3VsdC5vdXRwdXRJbmRpY2VzLmRhdGEoKSxcbiAgICAgICAgW1swLCAwXSwgWzEsIDBdLCBbMSwgM10sIFsxLCA0XSwgWzIsIDBdLCBbMywgMl0sIFszLCAzXSwgWzQsIDBdXSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoXG4gICAgICAgIGF3YWl0IHJlc3VsdC5vdXRwdXRWYWx1ZXMuZGF0YSgpLCBbMCwgMTAsIDEzLCAxNCwgLTEsIDMyLCAzMywgLTFdKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShhd2FpdCByZXN1bHQuZW1wdHlSb3dJbmRpY2F0b3IuZGF0YSgpLCBbMCwgMCwgMSwgMCwgMV0pO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKGF3YWl0IHJlc3VsdC5yZXZlcnNlSW5kZXhNYXAuZGF0YSgpLCBbMCwgMSwgMiwgMywgNSwgNl0pO1xuICB9KTtcblxuICBpdCgnbm8gZW1wdHkgcm93cycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBzcGFyc2VUZW5zb3IgPSB7XG4gICAgICBpbmQ6IHRmLnRlbnNvcjJkKFtbMCwgMF0sIFsxLCAwXSwgWzEsIDNdLCBbMSwgNF1dLCBbNCwgMl0sICdpbnQzMicpLFxuICAgICAgdmFsOiBbMCwgMTAsIDEzLCAxNF0sXG4gICAgICBzaGFwZTogWzIsIDZdLFxuICAgIH07XG4gICAgY29uc3QgcmVzdWx0ID0gdGYuc3BhcnNlLnNwYXJzZUZpbGxFbXB0eVJvd3MoXG4gICAgICAgIHNwYXJzZVRlbnNvci5pbmQsIHNwYXJzZVRlbnNvci52YWwsIHNwYXJzZVRlbnNvci5zaGFwZSwgLTEpO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKFxuICAgICAgICBhd2FpdCByZXN1bHQub3V0cHV0SW5kaWNlcy5kYXRhKCksIFtbMCwgMF0sIFsxLCAwXSwgWzEsIDNdLCBbMSwgNF1dKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShhd2FpdCByZXN1bHQub3V0cHV0VmFsdWVzLmRhdGEoKSwgWzAsIDEwLCAxMywgMTRdKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShhd2FpdCByZXN1bHQuZW1wdHlSb3dJbmRpY2F0b3IuZGF0YSgpLCBbMCwgMF0pO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKGF3YWl0IHJlc3VsdC5yZXZlcnNlSW5kZXhNYXAuZGF0YSgpLCBbMCwgMSwgMiwgM10pO1xuICB9KTtcblxuICBpdCgnbm8gZW1wdHkgcm93cyBhbmQgdW5vcmRlcmVkJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHNwYXJzZVRlbnNvciA9IHtcbiAgICAgIGluZDogdGYudGVuc29yMmQoW1sxLCAyXSwgWzEsIDNdLCBbMCwgMV0sIFswLCAzXV0sIFs0LCAyXSwgJ2Zsb2F0MzInKSxcbiAgICAgIHZhbDogWzEsIDMsIDIsIDRdLFxuICAgICAgc2hhcGU6IFsyLCA1XSxcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IHRmLnNwYXJzZS5zcGFyc2VGaWxsRW1wdHlSb3dzKFxuICAgICAgICBzcGFyc2VUZW5zb3IuaW5kLCBzcGFyc2VUZW5zb3IudmFsLCBzcGFyc2VUZW5zb3Iuc2hhcGUsIC0xKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShcbiAgICAgICAgYXdhaXQgcmVzdWx0Lm91dHB1dEluZGljZXMuZGF0YSgpLCBbWzAsIDFdLCBbMCwgM10sIFsxLCAyXSwgWzEsIDNdXSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoYXdhaXQgcmVzdWx0Lm91dHB1dFZhbHVlcy5kYXRhKCksIFsyLCA0LCAxLCAzXSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoYXdhaXQgcmVzdWx0LmVtcHR5Um93SW5kaWNhdG9yLmRhdGEoKSwgWzAsIDBdKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShhd2FpdCByZXN1bHQucmV2ZXJzZUluZGV4TWFwLmRhdGEoKSwgWzIsIDMsIDAsIDFdKTtcbiAgfSk7XG5cbiAgaXQoJ25vIHJvd3MnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3BhcnNlVGVuc29yID0ge1xuICAgICAgaW5kOiB0Zi50ZW5zb3IyZChbXSwgWzAsIDJdLCAnaW50MzInKSxcbiAgICAgIHZhbDogW10gYXMgbnVtYmVyW10sXG4gICAgICBzaGFwZTogWzAsIDVdLFxuICAgIH07XG4gICAgY29uc3QgcmVzdWx0ID0gdGYuc3BhcnNlLnNwYXJzZUZpbGxFbXB0eVJvd3MoXG4gICAgICAgIHNwYXJzZVRlbnNvci5pbmQsIHNwYXJzZVRlbnNvci52YWwsIHNwYXJzZVRlbnNvci5zaGFwZSwgLTEpO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKGF3YWl0IHJlc3VsdC5vdXRwdXRJbmRpY2VzLmRhdGEoKSwgW10pO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKGF3YWl0IHJlc3VsdC5vdXRwdXRWYWx1ZXMuZGF0YSgpLCBbXSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoYXdhaXQgcmVzdWx0LmVtcHR5Um93SW5kaWNhdG9yLmRhdGEoKSwgW10pO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKGF3YWl0IHJlc3VsdC5yZXZlcnNlSW5kZXhNYXAuZGF0YSgpLCBbXSk7XG4gIH0pO1xuXG4gIGl0KCdjaGVjayBvdXRwdXQgbWV0YWRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3BhcnNlVGVuc29yID0ge1xuICAgICAgaW5kOiB0Zi50ZW5zb3IyZChcbiAgICAgICAgICBbWzAsIDBdLCBbMSwgMF0sIFsxLCAzXSwgWzEsIDRdLCBbMywgMl0sIFszLCAzXV0sIFs2LCAyXSwgJ2ludDMyJyksXG4gICAgICB2YWw6IHRmLnRlbnNvcjFkKFswLCAxMCwgMTMsIDE0LCAzMiwgMzNdLCAnZmxvYXQzMicpLFxuICAgICAgc2hhcGU6IFs1LCA2XSxcbiAgICB9O1xuICAgIGNvbnN0IHJlc3VsdCA9IHRmLnNwYXJzZS5zcGFyc2VGaWxsRW1wdHlSb3dzKFxuICAgICAgICBzcGFyc2VUZW5zb3IuaW5kLCBzcGFyc2VUZW5zb3IudmFsLCBzcGFyc2VUZW5zb3Iuc2hhcGUsIC0xKTtcblxuICAgIGV4cGVjdEFycmF5c0Nsb3NlKFxuICAgICAgICBhd2FpdCByZXN1bHQub3V0cHV0SW5kaWNlcy5kYXRhKCksXG4gICAgICAgIFtbMCwgMF0sIFsxLCAwXSwgWzEsIDNdLCBbMSwgNF0sIFsyLCAwXSwgWzMsIDJdLCBbMywgM10sIFs0LCAwXV0pO1xuICAgIGV4cGVjdEFycmF5c0Nsb3NlKFxuICAgICAgICBhd2FpdCByZXN1bHQub3V0cHV0VmFsdWVzLmRhdGEoKSwgWzAsIDEwLCAxMywgMTQsIC0xLCAzMiwgMzMsIC0xXSk7XG4gICAgZXhwZWN0QXJyYXlzQ2xvc2UoYXdhaXQgcmVzdWx0LmVtcHR5Um93SW5kaWNhdG9yLmRhdGEoKSwgWzAsIDAsIDEsIDAsIDFdKTtcbiAgICBleHBlY3RBcnJheXNDbG9zZShhd2FpdCByZXN1bHQucmV2ZXJzZUluZGV4TWFwLmRhdGEoKSwgWzAsIDEsIDIsIDMsIDUsIDZdKTtcblxuICAgIGV4cGVjdChyZXN1bHQub3V0cHV0SW5kaWNlcy5zaGFwZSkudG9FcXVhbChbOCwgMl0pO1xuICAgIGV4cGVjdChyZXN1bHQub3V0cHV0VmFsdWVzLnNoYXBlKS50b0VxdWFsKFs4XSk7XG4gICAgZXhwZWN0KHJlc3VsdC5lbXB0eVJvd0luZGljYXRvci5zaGFwZSkudG9FcXVhbChbNV0pO1xuICAgIGV4cGVjdChyZXN1bHQucmV2ZXJzZUluZGV4TWFwLnNoYXBlKS50b0VxdWFsKFs2XSk7XG5cbiAgICBleHBlY3QocmVzdWx0Lm91dHB1dEluZGljZXMuZHR5cGUpLnRvRXF1YWwoc3BhcnNlVGVuc29yLmluZC5kdHlwZSk7XG4gICAgZXhwZWN0KHJlc3VsdC5vdXRwdXRWYWx1ZXMuZHR5cGUpLnRvRXF1YWwoc3BhcnNlVGVuc29yLnZhbC5kdHlwZSk7XG4gICAgZXhwZWN0KHJlc3VsdC5lbXB0eVJvd0luZGljYXRvci5kdHlwZSkudG9FcXVhbCgnYm9vbCcpO1xuICAgIGV4cGVjdChyZXN1bHQucmV2ZXJzZUluZGV4TWFwLmR0eXBlKS50b0VxdWFsKHNwYXJzZVRlbnNvci5pbmQuZHR5cGUpO1xuICB9KTtcblxuICBpdCgndGhyb3cgZXJyb3IgaWYgZGVuc2Ugcm93cyBpcyBlbXB0eSBhbmQgaW5kaWNlcyBpcyBub3QnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc3BhcnNlVGVuc29yID0ge1xuICAgICAgaW5kOiB0Zi50ZW5zb3IyZChbWzAsIDBdXSwgWzEsIDJdLCAnaW50MzInKSxcbiAgICAgIHZhbDogWzFdLFxuICAgICAgc2hhcGU6IFswLCA1XSxcbiAgICB9O1xuICAgIGV4cGVjdChcbiAgICAgICAgKCkgPT4gdGYuc3BhcnNlLnNwYXJzZUZpbGxFbXB0eVJvd3MoXG4gICAgICAgICAgICBzcGFyc2VUZW5zb3IuaW5kLCBzcGFyc2VUZW5zb3IudmFsLCBzcGFyc2VUZW5zb3Iuc2hhcGUsIC0xKSlcbiAgICAgICAgLnRvVGhyb3dFcnJvcigvaW5kaWNlc1xcLnNoYXBlXFxbMFxcXSA9IDEvKTtcbiAgfSk7XG5cbiAgaXQoJ3Rocm93IGVycm9yIGlmIG5lZ2F0aXZlIHJvdycsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBzcGFyc2VUZW5zb3IgPSB7XG4gICAgICBpbmQ6IHRmLnRlbnNvcjJkKFtbLTEsIDBdXSwgWzEsIDJdLCAnaW50MzInKSxcbiAgICAgIHZhbDogWzFdLFxuICAgICAgc2hhcGU6IFs1LCA1XSxcbiAgICB9O1xuICAgIGV4cGVjdChcbiAgICAgICAgKCkgPT4gdGYuc3BhcnNlLnNwYXJzZUZpbGxFbXB0eVJvd3MoXG4gICAgICAgICAgICBzcGFyc2VUZW5zb3IuaW5kLCBzcGFyc2VUZW5zb3IudmFsLCBzcGFyc2VUZW5zb3Iuc2hhcGUsIC0xKSlcbiAgICAgICAgLnRvVGhyb3dFcnJvcignaW5kaWNlcygwLCAwKSBpcyBpbnZhbGlkOiAtMSA8IDAnKTtcbiAgfSk7XG5cbiAgaXQoJ3Rocm93IGVycm9yIGlmIHJvdyBleGNlZWRzIG51bWJlciBvZiBkZW5zZSByb3dzJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHNwYXJzZVRlbnNvciA9IHtcbiAgICAgIGluZDogdGYudGVuc29yMmQoW1s1LCAwXV0sIFsxLCAyXSwgJ2ludDMyJyksXG4gICAgICB2YWw6IFsxXSxcbiAgICAgIHNoYXBlOiBbNSwgNV0sXG4gICAgfTtcbiAgICBleHBlY3QoXG4gICAgICAgICgpID0+IHRmLnNwYXJzZS5zcGFyc2VGaWxsRW1wdHlSb3dzKFxuICAgICAgICAgICAgc3BhcnNlVGVuc29yLmluZCwgc3BhcnNlVGVuc29yLnZhbCwgc3BhcnNlVGVuc29yLnNoYXBlLCAtMSkpXG4gICAgICAgIC50b1Rocm93RXJyb3IoJ2luZGljZXMoMCwgMCkgaXMgaW52YWxpZDogNSA+PSA1Jyk7XG4gIH0pO1xufSk7XG4iXX0=